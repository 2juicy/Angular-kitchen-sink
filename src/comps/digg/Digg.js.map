{"version":3,"file":"Digg.js","sourceRoot":"","sources":["Digg.ts"],"names":[],"mappings":"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","sourcesContent":["import {\r\n    Component,\r\n    ViewContainerRef,\r\n    ViewEncapsulation,\r\n    Inject\r\n} from \"@angular/core\";\r\nimport {DOCUMENT} from \"@angular/platform-browser\";\r\nimport {Consts} from \"../../../src/Conts\";\r\nimport {Observable} from \"rxjs/Observable\";\r\nimport {DiggLoader} from \"../../../src/comps/digg/DiggLoader\";\r\nimport {Observer} from \"rxjs/Observer\";\r\nimport {IDigg} from \"./DiggLoader\";\r\nimport {\r\n    CommBroker,\r\n    IMessage\r\n} from \"../../services/CommBroker\";\r\nimport \"rxjs/add/observable/from\";\r\nimport \"rxjs/add/operator/do\";\r\nimport \"rxjs/add/operator/debounceTime\";\r\nimport \"rxjs/add/operator/distinctUntilChanged\";\r\nimport {Lib} from \"../../Lib\";\r\n\r\n@Component({\r\n    selector: 'Digg',\r\n    inputs: ['mode:mode'],\r\n    encapsulation: ViewEncapsulation.Emulated, // so we don't bleed our styles to rest of dom\r\n    providers: [DiggLoader],\r\n    styles: [`\r\n        .diggContainer {\r\n            overflow-y: scroll;\r\n            height: 300px;\r\n        };\r\n        .largeImage {\r\n           max-width: 100px;\r\n           max-height: 60px;\r\n        }\r\n        .smallImage {\r\n           width: 70px;\r\n           height: 40px;\r\n        }\r\n        .grow { transition: all .2s ease-in-out; }\r\n        .grow:hover { transform: scale(1.1); opacity: 0.7}\r\n    `],\r\n    template: `\r\n        <h1>Digg</h1>\r\n        <h6>Automatically show Component name using Reflection:\r\n            <small class=\"debug\">component name: {{me}}</small>\r\n        </h6>\r\n        \r\n        <div class=\"appHeight\" HeightDirective (resizing)=\"smallHeight = $event\">\r\n                 <h5>\r\n                    component height: {{smallHeight}}px\r\n                </h5>\r\n             <form (submit)=\"$event.preventDefault();\">\r\n                <br/>\r\n                <div class=\"input-group\">\r\n                      <span class=\"input-group-addon\" id=\"symbol-input\">Digg filter</span>\r\n                      <input type=\"text\" class=\"form-control\" (keyup)=\"onSearch($event)\" placeholder=\"press [ENTER] for unfiltered result\">\r\n                    </div>\r\n              </form>\r\n              <div class=\"diggContainer list\">\r\n                  <table class=\"table table-striped\">\r\n                  <tbody>\r\n                    <tr *ngFor=\"let digg of diggs\" [ngClass]=\"{'col-xs-4': tileStyle, 'col-lg-3': tileStyle}\">\r\n                      <td>\r\n                      <img class=\"img-responsive grow\" [ngClass]=\"{'largeImage': tileStyle, 'smallImage': !tileStyle}\" src=\"{{digg.link}}\"/>\r\n                      <span>{{digg.title}}</span>\r\n                      </td>\r\n                    </tr>\r\n                  </tbody>\r\n                </table>\r\n              </div>\r\n        </div>\r\n  `\r\n})\r\n\r\nexport class Digg {\r\n    private mode: string;\r\n    private tileStyle: boolean;\r\n    private channel: Observable<any>;\r\n    private stream: Observer<any[]>;\r\n    private diggs: IDigg[];\r\n    private el: any;\r\n    private viewContainer: ViewContainerRef;\r\n    private dom: HTMLBodyElement;\r\n\r\n    constructor(private commBroker: CommBroker, diggLoader: DiggLoader, @Inject(DOCUMENT) private doc, private m_commBroker: CommBroker, viewContainer: ViewContainerRef) {\r\n        var self = this;\r\n        self.mode = 'list';\r\n        this.dom = this.doc.body;\r\n        this.diggs = [];\r\n        self.viewContainer = viewContainer;\r\n        self.el = viewContainer.element.nativeElement;\r\n        self['me'] = Lib.GetCompSelector(this.constructor)\r\n\r\n\r\n        self.channel = new Observable(observer => {\r\n            self.stream = observer;\r\n        }).share();\r\n\r\n        // for a cleaner approach to Observable endpoint server calls see Weather component\r\n        self.channel.debounceTime(1000).distinctUntilChanged().subscribe((e) => {\r\n            self.diggs = [];\r\n            diggLoader.loadDiggs(e, self.diggs)\r\n        });\r\n        this.listenWinResize();\r\n        var propView = this.commBroker.getService(Consts.Services().Properties);\r\n        if (propView)\r\n            propView.setPropView('Digg');\r\n    }\r\n\r\n    private listenWinResize() {\r\n        var self = this;\r\n        self.m_commBroker.onEvent(Consts.Events().WIN_SIZED).subscribe((e: IMessage) => {\r\n            self.setSize(e.message.height)\r\n        });\r\n    }\r\n\r\n    ngAfterContentInit() {\r\n        this.tileStyle = this.mode == \"tiles\" ? true : false;\r\n        this.setSize(this.m_commBroker.getValue(Consts.Values().APP_SIZE).height);\r\n    }\r\n\r\n    private setSize(height) {\r\n        var h: any = height - 400;\r\n        var el = jQuery(this.dom).find('diggContainer', this.el)[0];\r\n        jQuery(this.dom).find(el).css({height: h});\r\n    }\r\n\r\n    private onSearch(event) {\r\n        this.stream.next(event.target.value);\r\n    }\r\n}"]}